# Проект транспонирования матрицы (CPU vs GPU)

Проект на чистом языке C для сравнения производительности транспонирования матрицы на CPU и GPU (CUDA).

## Особенности

- ✅ Реализация на CPU (последовательная)
- ✅ Две реализации на GPU:
  - Naive версия (прямой доступ к глобальной памяти)
  - Оптимизированная версия с shared memory
- ✅ Поддержка квадратных и неквадратных матриц
- ✅ Автоматическое измерение производительности
- ✅ Сохранение результатов в CSV
- ✅ Скрипт для построения графиков

## Структура проекта

- `main.c` - основная программа с замерами времени и сохранением результатов
- `transpose_cpu.h` / `transpose_cpu.c` - CPU версия транспонирования
- `transpose_cuda.cuh` / `transpose_cuda.cu` - GPU версия транспонирования (CUDA)
  - `transpose_naive_kernel` - базовое ядро
  - `transpose_shared_kernel` - оптимизированное ядро с shared memory
- `utils.h` / `utils.c` - вспомогательные функции
- `device_info.cu` - функции для работы с CUDA устройством
- `plot_results.py` - скрипт для построения графиков результатов

## Требования

- Компилятор C/C++ (gcc, MSVC, или MinGW)
- NVIDIA CUDA Toolkit (12.0 или выше)
- Видеокарта NVIDIA с поддержкой CUDA
- Python 3 с matplotlib (для построения графиков)

## Быстрая сборка

### Windows (рекомендуется):

```powershell
.\build_custom.bat
```

Или используйте другие скрипты:
- `build.bat` - автоматический выбор компилятора
- `build_simple.bat` - упрощенная сборка
- `build_one_line.bat` - однострочная команда

### Linux/Mac:

```bash
make
```

## Использование

После компиляции запустите:

```powershell
.\lab3_transpose.exe
```

Программа автоматически выполнит тесты для следующих матриц:

**Квадратные:**
- 256×256, 512×512, 1024×1024, 2048×2048, 4096×4096, 8192×8192

**Неквадратные:**
- 256×512, 512×256 (узкие/широкие)
- 1024×2048, 2048×1024
- 512×1024, 1024×512

## Результаты

Программа сохраняет результаты в файл `results.csv` со следующими колонками:

- `rows` - количество строк исходной матрицы
- `cols` - количество столбцов исходной матрицы
- `cpu_time_ms` - время выполнения на CPU (миллисекунды)
- `gpu_naive_time_ms` - время выполнения на GPU (naive версия)
- `gpu_shared_time_ms` - время выполнения на GPU (shared memory версия)
- `speedup_naive` - ускорение GPU naive относительно CPU
- `speedup_shared` - ускорение GPU shared относительно CPU
- `correct` - корректность результатов (1 = совпадают, 0 = не совпадают)

### Построение графиков

```bash
python plot_results.py
```

Создаст график `transpose_plot.png` с двумя подграфиками:
- Квадратные матрицы (по размеру N)
- Неквадратные матрицы (по количеству элементов)

## Пример вывода

```
=== Транспонирование матрицы (CPU vs GPU) ===

CUDA доступна: NVIDIA GeForce RTX 3050 (Compute 8.6)

Rows x Cols | CPU (мс) | GPU naive (мс) | GPU shared (мс) | Ускорение
------------|----------|----------------|-----------------|----------
 256 x 256  |    0.151 |          4.682 |           0.378 | 0.40x
 512 x 512  |    0.764 |          0.722 |           0.602 | 1.27x
1024 x 1024 |    4.191 |          1.775 |           1.547 | 2.71x
2048 x 2048 |   29.169 |          5.798 |           5.413 | 5.39x
4096 x 4096 |  232.356 |         20.203 |          17.502 | 13.28x
8192 x 8192 | 1041.332 |         93.532 |          68.589 | 15.18x

Результаты сохранены в results.csv
```

## Архитектура GPU

Проект настроен для архитектуры **sm_86** (RTX 3050/3060/3070/3080/3090).

Для других видеокарт измените `-arch=sm_86` на соответствующую архитектуру:
- RTX 4090: `sm_89`
- GTX 1660: `sm_75`
- GTX 1080: `sm_61`

## Документация

- `COMPILE_GUIDE.md` - подробное руководство по компиляции
- `QUICK_START.md` - быстрый старт
- `ALGORITHM_ILLUSTRATIONS.md` - визуальные иллюстрации алгоритмов
- `CHANGES.md` - история изменений

## Лицензия

Этот проект создан в учебных целях.
